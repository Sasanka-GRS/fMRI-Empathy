%% Weighted Graph

WOriginal = [0,0.54,0.14,0,0,0,0,0.47;0.54,0,0.63,0.35,0.30,0,0,0.31;0.14,0.63,0,0.31,0,0,0,0;0,0.35,0.31,0,0.54,0.43,0,0.13;0,0.30,0,0.54,0,0.54,0.62,0.54;0,0,0,0.43,0.54,0,0.37,0;0,0,0,0,0.62,0.37,0,0;0.47,0.31,0,0.13,0.54,0,0,0];
P = 10000;
x1 = [-1,-1,1,-1,-1,1,-1,-1]';
lambda = 1.7;
N = 8;
iter = 100;

x = zeros(N,P);
for i = 1:P
    a = randn(N,1);
    for j = 1:N
        if(x1(j)~=-1)
            x(j,i) = x1(j);
        else
            x(j,i) = randn(1,1);
        end
    end
end

Lay = [-2,-2;-1,0;-2,2;0,2;1,0;2,2;2,-2;0,-2];
node = 1:N;

[WLearnt,Layout] = sparLearn(x,lambda,N,Lay,iter);

figure()
subplot(1,2,1);
plotting(Layout,WOriginal,zeros(N),node);
title('Original graph', 'FontSize',20);
xlim([-4,4]);
ylim([-4,4]);
subplot(1,2,2);
WLearnt = [0,0.24,0,0,0,0,0,0.36;0.55,0,0.86,0.22,0,0,0,0.18;0,0.31,0,0.13,0,0,0,0;0,0.19,0,0,0.28,0.18,0,0;0,0.01,0,0.39,0,0.42,0.43,0.36;0,0,0,0.18,0.19,0,0.44,0;0,0,0,0,0.23,0.30,0,0;0.32,0.16,0,0,0.21,0,0,0];
plotting(Layout,WLearnt,zeros(N),node);
title('Learnt graph', 'FontSize',20);
xlim([-4,4]);
ylim([-4,4]);

figure()
subplot(1,2,1);
image(WOriginal,"CDataMapping","scaled");
clim([0 1]);
colorbar;
title('Original Weight Matrix', 'FontSize',20);
subplot(1,2,2);
image(WLearnt,"CDataMapping","scaled");
clim([0 1]);
colorbar;
title('Learnt Weight Matrix', 'FontSize',20);

%% Unweighted Graph

WOriginal = [0,0.54,0.14,0,0,0,0,0.47;0.54,0,0.63,0.35,0.30,0,0,0.31;0.14,0.63,0,0.31,0,0,0,0;0,0.35,0.31,0,0.54,0.43,0,0.13;0,0.30,0,0.54,0,0.54,0.62,0.54;0,0,0,0.43,0.54,0,0.37,0;0,0,0,0,0.62,0.37,0,0;0.47,0.31,0,0.13,0.54,0,0,0];
WL0 = [0,0.540000000000000,0.140000000000000,0,0,0,0,0.470000000000000;0.540000000000000,0,0.630000000000000,0,0.300000000000000,0,0,0.310000000000000;0.140000000000000,0.630000000000000,0,0.310000000000000,0,0,0,0;0,0,0.310000000000000,0,0.540000000000000,0.430000000000000,0,0.130000000000000;0,0.300000000000000,0,0.540000000000000,0,0.540000000000000,0.620000000000000,0.540000000000000;0,0,0,0.430000000000000,0.540000000000000,0,0.370000000000000,0;0,0,0,0,0.620000000000000,0.370000000000000,0,0;0.470000000000000,0.310000000000000,0,0.130000000000000,0.540000000000000,0,0,0];
WL1 = [0,0.540000000000000,0.140000000000000,0,0,0,0,0;0.540000000000000,0,0.630000000000000,0.350000000000000,0.300000000000000,0,0,0;0.140000000000000,0.630000000000000,0,0.310000000000000,0,0,0,0;0,0.350000000000000,0.310000000000000,0,0.540000000000000,0,0,0.130000000000000;0,0.300000000000000,0,0.540000000000000,0,0.540000000000000,0.620000000000000,0.540000000000000;0,0,0,0,0.540000000000000,0,0.370000000000000,0;0,0,0,0,0.620000000000000,0.370000000000000,0,0;0,0,0,0.130000000000000,0.540000000000000,0,0,0];
WL2 = [0,0.540000000000000,0,0,0,0,0,0.470000000000000;0.540000000000000,0,0.630000000000000,0.350000000000000,0.300000000000000,0,0,0.310000000000000;0,0.630000000000000,0,0.310000000000000,0,0,0,0;0,0.350000000000000,0.310000000000000,0,0.540000000000000,0.430000000000000,0,0.130000000000000;0,0.300000000000000,0,0.540000000000000,0,0.540000000000000,0,0.540000000000000;0,0,0,0.430000000000000,0.540000000000000,0,0.370000000000000,0;0,0,0,0,0,0.370000000000000,0,0;0.470000000000000,0.310000000000000,0,0.130000000000000,0.540000000000000,0,0,0];
WOriginal(WOriginal>0) = 1;
WL0(WL0>0)=1;
WL1(WL1>0)=1;
WL2(WL2>0)=1;
P = 10000;
x1 = [-1,-1,5,-1,-1,5,-1,-1]';
lambda = 1.7;
N = 8;
iter = 10;

x = zeros(N,P);
for i = 1:P
    a = randn(N,1);
    for j = 1:N
        if(x1(j)~=-1)
            x(j,i) = x1(j);
        else
            x(j,i) = randn(1,1);
        end
    end
end

Lay = [-2,-2;-1,0;-2,2;0,2;1,0;2,2;2,-2;0,-2];
node = 1:N;

[WLearnt,Layout] = sparLearn(x,lambda,N,Lay,iter);

figure()
subplot(1,2,1);
plotting(Layout,WOriginal,zeros(N),node);
title('Original graph', 'FontSize',20);
xlim([-4,4]);
ylim([-4,4]);
subplot(1,2,2);
%WLearnt = [0,0.24,0,0,0,0,0,0.36;0.55,0,0.86,0.22,0,0,0,0.18;0,0.31,0,0.13,0,0,0,0;0,0.19,0,0,0.28,0.18,0,0;0,0.01,0,0.39,0,0.42,0.43,0.36;0,0,0,0.18,0.19,0,0.44,0;0,0,0,0,0.23,0.30,0,0;0.32,0.16,0,0,0.21,0,0,0];
plotting(Layout,WOriginal,zeros(N),node);
title('Learnt graph', 'FontSize',20);
xlim([-4,4]);
ylim([-4,4]);

figure()
subplot(1,3,1);
image(WL0,"CDataMapping","scaled");
clim([0 1]);
colorbar;
title('Sparsity Correlation Method', 'FontSize',20);
subplot(1,3,2);
image(WL1,"CDataMapping","scaled");
clim([0 1]);
colorbar;
title('Smoothness Method', 'FontSize',20);
subplot(1,3,3);
image(WL2,"CDataMapping","scaled");
clim([0 1]);
colorbar;
title('Similarity method', 'FontSize',20);